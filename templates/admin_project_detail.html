{% extends 'base.html' %}

{% block title %}{{ project.name }} - ì‚¬ì§„ ê´€ë¦¬{% endblock %}

{% block content %}
<div style="margin-bottom: 24px;">
    <a href="{{ url_for('admin_dashboard') }}" style="color: var(--gray-500); text-decoration: none; font-size: 0.875rem;">
        â† ëŒ€ì‹œë³´ë“œ
    </a>
    <h1 style="font-size: 1.5rem; font-weight: 700; margin-top: 8px;">{{ project.name }}</h1>
</div>

<div class="stats">
    <div class="stat-item">
        <div class="stat-value">{{ project.photo_count }}</div>
        <div class="stat-label">ì „ì²´</div>
    </div>
    <div class="stat-item">
        <div class="stat-value" style="color: var(--success);">{{ project.downloaded_count }}</div>
        <div class="stat-label">ë‹¤ìš´ë¡œë“œ</div>
    </div>
    <div class="stat-item">
        <div class="stat-value" style="color: var(--warning);">{{ project.photo_count - project.downloaded_count }}</div>
        <div class="stat-label">ë¯¸ë‹¤ìš´ë¡œë“œ</div>
    </div>
</div>

{% if project.photos %}
    <div style="margin-bottom: 16px;">
        <a href="{{ url_for('admin_project_download_all', project_id=project.id) }}" class="btn btn-success btn-block">
            ğŸ“¥ ì „ì²´ ë‹¤ìš´ë¡œë“œ (ZIP)
        </a>
    </div>
    
    {% for uploader_name, photos in uploaders.items() %}
        <div class="uploader-section">
            <div class="uploader-header">
                <div>
                    <span class="uploader-name">ğŸ‘¤ {{ uploader_name }}</span>
                    <span class="uploader-count">{{ photos|length }}ì¥</span>
                </div>
                <a href="{{ url_for('admin_uploader_download', project_id=project.id, uploader_name=uploader_name) }}" 
                   class="btn btn-outline btn-sm">
                    ğŸ“¥ ë‹¤ìš´ë¡œë“œ
                </a>
            </div>
            
            <div class="photo-list">
                {% for photo in photos %}
                    <div class="photo-item {{ 'downloaded' if photo.is_downloaded else '' }}" style="display: flex; align-items: center; padding: 12px; background: var(--gray-50); border-radius: 8px; margin-bottom: 8px;">
                        <div style="flex: 1;">
                            <p style="font-weight: 500; margin-bottom: 4px;">{{ photo.original_filename }}</p>
                            <p style="font-size: 0.75rem; color: var(--gray-500);">
                                {{ photo.file_size_display }} Â· {{ photo.uploaded_at.strftime('%m/%d %H:%M') }}
                                {% if photo.is_downloaded %}
                                    <span style="color: var(--success);">âœ“ ë‹¤ìš´ë¡œë“œë¨</span>
                                {% endif %}
                            </p>
                        </div>
                        <div style="display: flex; gap: 8px;">
                            <a href="{{ url_for('admin_photo_download', photo_id=photo.id) }}" class="btn btn-primary btn-sm">
                                ğŸ“¥
                            </a>
                            <form action="{{ url_for('admin_photo_delete', photo_id=photo.id) }}" method="POST" style="display: inline;"
                                  onsubmit="return confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
                                <button type="submit" class="btn btn-danger btn-sm">ğŸ—‘</button>
                            </form>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% endfor %}
{% else %}
    <div class="empty-state">
        <div class="icon">ğŸ“·</div>
        <p>ì•„ì§ ì—…ë¡œë“œëœ ì‚¬ì§„ì´ ì—†ìŠµë‹ˆë‹¤.</p>
    </div>
{% endif %}
{% endblock %}
